<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Börse 2 U</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    
    <!-- Header Anfang -->
    <header class="p-3 bg-dark text-white" style="display: none;">
        <div class="container">
        <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
            <strong>Happy Börse 2 U</strong>
            </a>
    
            <ul class="nav col-12 col-lg-auto me-lg-auto ms-4 mb-2 justify-content-center mb-md-0">
            <li><a href="" class="nav-link px-2 text-white">Home</a></li>
            <!-- <li><a href="#" class="nav-link px-2 text-white">Features</a></li>
            <li><a href="#" class="nav-link px-2 text-white">Pricing</a></li>
            <li><a href="#" class="nav-link px-2 text-white">FAQs</a></li>
            <li><a href="#" class="nav-link px-2 text-white">About</a></li> -->
            </ul>
    
            <!-- <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3">
            <input type="search" class="form-control form-control-dark" placeholder="Search..." aria-label="Search">
            </form> -->
    
            <!-- <div class="text-end">
            <button type="button" class="btn btn-outline-light me-2">Login</button>
            <button type="button" class="btn btn-warning">Sign-up</button>
            </div> -->

        </div>
        </div>
    </header>
    <!-- Header Ende -->

    <div class="wrapper m-4">

        <!-- Titel -->
        <h1 class="my-5">Happy Börse 2 U</h1>

        <!-- Suche -->
        <div class="mb-3 row">
            <label for="exampleDataList" class="col-sm-3 col-form-label">Suche nach einer Aktie <!--symbols or companies--></label>
            <div class="col-sm-8">
                <input class="form-control" list="datalistOptions" id="exampleDataList" placeholder="Type to search...">
                <datalist id="datalistOptions">
                </datalist>
            </div>
        </div>

        <!-- Weiteres (Diagramme, etc.) -->

    </div>


    <script>

        apiKey ='QQQLXZK291FP2Z1O'; // Max
        //apiKey ='NPQAZZM6L5260BY2'; // Falk
        
        // autocomplete bei der Suche
        $('#exampleDataList').on('input', function() {

            removeAllItemsFromSearchList();

            if($('#exampleDataList').val() != '') {
                
                //enableSearchInput(false);

                // API Suche nach Unternehmen:
                // https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=tesco&apikey=demo
                $.ajax({
                    type:"GET", 
                    url: "https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=" + $('#exampleDataList').val() + "&apikey=" + apiKey,
                    beforeSend: function(){
                    },
                    success: function(data) {

                        // console.log(data);

                        if(data['bestMatches']) {

                            console.log(data['bestMatches']);

                            data['bestMatches'].forEach(function(item) {
                                
                                // console.log(item);
                                //console.log(item['2. name'] + " // " + item['1. symbol']);
                                
                                $("#datalistOptions").append('<option class="searchResultItem" value="' + item['1. symbol'] + '">' + item['2. name'] + ' // ' + item['4. region'] + '</option>');

                            });

                        } else {
                            alert(JSON.stringify(data));
                        }

                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        alert(jqXHR.status);
                    },
                    complete: function(data) {
                        //enableSearchInput(true);
                    },
                    dataType: "json",
                });

            }

        });

        function enableSearchInput(bol) {
            if(bol) {
                $("#exampleDataList").prop('disabled', false);
                $("#exampleDataList").focus();
            } else {
                $("#exampleDataList").prop('disabled', true);
            }
        }

        function removeAllItemsFromSearchList() {
            /*close all autocomplete lists in the document,
            except the one passed as an argument:*/
            // var x = document.getElementsByClassName("searchResultItem");
            // for (var i = 0; i < x.length; i++) {
            //     //x[i].parentNode.removeChild(x[i]);
            //     x[i].remove();
            // }

            $('#datalistOptions').empty();
        }

        function loadSymbolData(symbol) {

            alert(symbol);

        }

        // $.ajax({
        //     type:"GET", 
        //     url: "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=IBM&apikey=" + apiKey, 
        //     success: function(data) {
        //             $("body").append(JSON.stringify(data));
        //             console.log(data);
        //             console.log(data['Meta Data']);
        //         }, 
        //     error: function(jqXHR, textStatus, errorThrown) {
        //             alert(jqXHR.status);
        //         },
        //     dataType: "json"
        // });

    </script>
    
</body>
</html>